using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class Malware : MonoBehaviour
{
    [SerializeField] private ParticleSystem destructionEffectPrefab;
    [SerializeField] private AudioClip destructionSound;
    [SerializeField] private float destructionSoundVolume = 1.0f;

    void OnMouseDown()
    {
        OnMalwareClicked();
    }
    public void OnMalwareClicked()
    {
        Debug.Log("Malware clicked");

        if (destructionSound != null)
        {
            AudioManager.instance.PlaySound(destructionSound, destructionSoundVolume);
            Debug.Log("Playing sound");
            
        }
        else
        {
            Debug.LogError("AudioSource or destructionSound is not assigned!");
        }

        if (destructionEffectPrefab != null)
        {
            ParticleSystem effect = Instantiate(destructionEffectPrefab, transform.position, Quaternion.identity);
            effect.Play();
            Destroy(effect.gameObject, effect.main.duration);
        }
        else
        {
            Debug.LogError("Destruction effect prefab not assigned");
        }

        Handheld.Vibrate();
        Destroy(gameObject);

        //Effect for sound or Destruction here
    }

    private void OnTriggerEnter2D(Collider2D other)
    {
        if (other.gameObject.CompareTag("Server"))
        {
            other.gameObject.GetComponent<Server>().HandleMalwareHit();
            Destroy(gameObject);
        }
    }
}
